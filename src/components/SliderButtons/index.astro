---
import './styles.css'
import FloatingButton from '../FloatingButton/index.astro'
import { FiChevronLeft, FiChevronRight } from 'react-icons/fi'

const buttons = [
  {
    className: 'left',
    icon: FiChevronLeft
  },
  {
    className: 'right',
    icon: FiChevronRight
  }
]
---

<>
  {
    buttons.map((button) => (
      <FloatingButton
        className={`slider-button ${button.className}`}
        disabled={button.className === 'left'}
      >
        <button.icon />
      </FloatingButton>
    ))
  }
</>

<script>
  const slider = document.querySelector('.slider') as HTMLElement

  const leftButton = document.querySelector(
    '.slider-button.left'
  ) as HTMLButtonElement
  const rightButton = document.querySelector(
    '.slider-button.right'
  ) as HTMLButtonElement

  const handleArrowClick = (direction: 'left' | 'right') => {
    const { clientWidth, scrollLeft } = slider

    let move = 0

    if (direction === 'left') move = -clientWidth
    else move = clientWidth

    slider.scrollTo({
      left: scrollLeft + move,
      behavior: 'smooth'
    })
  }

  leftButton.addEventListener('click', () => handleArrowClick('left'))
  rightButton.addEventListener('click', () => handleArrowClick('right'))

  const handleDisablingButtons = () => {
    const { clientWidth, scrollLeft, scrollWidth } = slider

    if (scrollLeft === 0) leftButton.disabled = true
    else leftButton.disabled = false

    if (scrollLeft + clientWidth >= scrollWidth) rightButton.disabled = true
    else rightButton.disabled = false
  }

  slider.addEventListener('scroll', handleDisablingButtons)
</script>
